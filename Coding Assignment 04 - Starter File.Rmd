---
title: "Coding Assignment 04 - Solution"
date: "`r Sys.Date()`"
output: html_document
text.align: justify
---

----

### Type your student name and ID

Name and ID:Aryan Bhavsar, 702660080

---

#### Task 1: Download the Admission dataset and set the work directory:

```{r}
# Make sure to set the work directory where you saved the dataset
```

----

#### Task 2: Download and load the required packages:

```{r}
#No need to install ggplot2, pastecs, psych, readr and naniar packages they have been already been installed so we just need to call them using the library() function. 
#install.packages("mice") Installing the mice packages
library(ggplot2)
library(pastecs)
library(psych)
library(readr)
library(naniar)
library(mice)
```

----

#### Task 3: Load, view and return the structure of the dataset.

```{r}
#Loading the Admission.csv and assigning it to variable called Admission
Admission<-read.csv("Admission.csv")
View(Admission) #Viewing the Admission dataset
str(Admission) #Returning the structure of Admission dataset
```

----

#### Task 4: Stroing categorical variables as factors in the dataset

```{r}
# storing categorical variables as factors in the dataset
# Turning the Major, Scool_GPA, and Admitted which are categorical in factors. 
Admission_New<- Admission # Assigning the dataset Admission to a new dataset 
Admission_New$Major = as.factor(Admission$Major) 
Admission_New$School_GPA = as.factor(Admission$School_GPA)
Admission_New$Admitted = as.factor(Admission$Admitted)
```

----

#### Task 5: Return Summary Statistics of the Admission Dataset:

```{r}
summary(Admission_New) # Don't if we need to use the new data set or the old one 
```

----

#### Task 6: Summary statistics using the pastecs package.

```{r}
# No need to reinstall the pastecs package it is already installed 
library(pastecs) # Loading the pastecs Package 
stat.desc(Admission_New) # Using the describe function to get the summary statistics
options(scipen=999) # To convert the values to absolute term 
```

----

#### Task 7: Using the describe function of the psych package to get the Summary statistics for all variables.

```{r}
# No need to reinstall the pastecs package it is already installed 
library(psych) # Loading the psych Package 
# Using the describe function to get the summary statistics for all variables 
describe(Admission_New)

```

----

#### Task 8: Using the describeBy function to get the Summary statistics for all variables by Major.

```{r}
# No need to reinstall the pastecs package it is already installed 
library(psych) # Loading the psych Package 
# Using the describe function to get the smmary statistics for all variables 
describeBy(Admission_New ~Major)
```

----

#### Task 9: Using the describeBy function to get the Summary statistics for all variables by Admitted

```{r}
# No need to reinstall the pastecs package it is already installed 
library(psych) # Loading the psych Package 
# Using the describe function to get the smmary statistics for all variables 
describeBy(Admission_New ~Admitted)
```


#### Task 10: Download the Students dataset and set the work directory:

```{r}
# Make sure to set the work directory where you saved the Students dataset
```

----

#### Task 11: Load, view and return the structure of the Students dataset.

```{r}
#read file and assign it to a dataset called Students
Students <- read.csv("Students.csv")
View(Students) #Viewing the students dataset 
str(Students)  #Viewing the structure of this dataset
```

----

#### Task 12: Exploring the dataset for missing values using the naniar package.

```{r}
n_miss(Students) # Return the number of missing values
n_complete(Students) # Return the number of complete values
pct_complete(Students) # Return the percentage % of complete values
pct_miss(Students) # Return the percentage % of missing values
pct_miss_case(Students) #Return the percentage % of rows with missing value
pct_complete_case(Students) #Return the percentage % of rows with no missing values
gg_miss_var(Students, show_pct=TRUE)  # Return the percentage % of missing values in a graph 
vis_miss(Students) #Returning a heat map of the missing values
```

----

#### Task 13: Data Imputation.

```{r}
#Dealing with missing values and impute the data
#Step 1: we need to creat a varaible to store the mice function
#Step 2 : we need to call the mice function and specify the following: 
  #step 2.1: specify our dataset which contains the missing values 
  #Step 2.b: specify m, how many imputed datasets we want 
  #Step 2.c: Specify the Imputation method for each variable by creating a vector c 
  # Step 2.d: Specify the maxit value. the higher, the better prediction 
  # The rf method (random forest) can handle mising values in categorigal variables 
  # The pmm method (predictive mean matching) can handle missing vaues in numercal variables
#imputed_dataset=mice(Students, m=5, method=c("","pmm","rf","rf","pmm"), maxit=5)
```

----

#### Task 14: Viewing the clean Imputed Dataset.

```{r}
#We need to creat a new dataset which will store the imputed dataset
#We will use the complete method to assign the values
#final_imputed_ds = complete(imputed_dataset,2) 
#View(final_imputed_ds) #Viewing the complete dataset
```
